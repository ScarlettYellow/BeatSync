# App 内购买产品类型修正

## ⚠️ 重要修正

### 之前的错误建议

我之前建议下载次数包使用 **"非消耗型产品"（Non-Consumable）**，这是**错误的**。

### 正确的产品类型

下载次数包应该使用 **"消耗型产品（Consumable）"**。

---

## 📋 产品类型说明

### App Store 产品类型

#### 1. 消耗型产品（Consumable）✅ **正确选择**

**特点**：
- ✅ 可以**多次购买**同一个产品
- ✅ 每次购买都会**消耗**
- ✅ 用完后需要**再次购买**
- ✅ 适合：游戏币、积分、下载次数等

**示例**：
- 游戏金币
- 积分
- **下载次数包** ⭐

#### 2. 非消耗型产品（Non-Consumable）❌ **错误选择**

**特点**：
- ❌ 只能**购买一次**
- ❌ 购买后**永久拥有**
- ❌ 不能再次购买
- ✅ 适合：解锁功能、移除广告等

**示例**：
- 解锁高级功能
- 移除广告
- 永久解锁

#### 3. 自动续订订阅（Auto-Renewable Subscription）

**特点**：
- ✅ 定期自动续费
- ✅ 适合：月度/年度订阅

#### 4. 非续订订阅（Non-Renewing Subscription）

**特点**：
- ⚠️ 需要手动续费
- ⚠️ 不常用

---

## 🔍 为什么下载次数包应该是消耗型产品？

### 业务逻辑分析

从代码逻辑来看：

1. **可以多次购买**：
   ```python
   # 用户可以多次购买 pack_10
   # 每次购买都会增加下载次数
   ```

2. **次数会被消耗**：
   ```python
   # 每次下载会减少 remaining_credits
   # 用完后需要再次购买
   ```

3. **用完后需要再次购买**：
   ```python
   # 10次用完后，用户可以再次购买 pack_10
   ```

### 符合消耗型产品的特征

- ✅ 可以多次购买同一个产品
- ✅ 每次购买都会消耗
- ✅ 用完后需要再次购买

---

## ✅ 正确的产品配置

### 订阅产品（4个）- 自动续订订阅

| 产品 ID | 类型 | 价格 |
|---------|------|------|
| `com.beatsync.subscription.basic.monthly` | 自动续订订阅 | ¥15/月 |
| `com.beatsync.subscription.basic.yearly` | 自动续订订阅 | ¥99/年 |
| `com.beatsync.subscription.premium.monthly` | 自动续订订阅 | ¥69/月 |
| `com.beatsync.subscription.premium.yearly` | 自动续订订阅 | ¥499/年 |

### 一次性购买（3个）- **消耗型产品** ⭐ 修正

| 产品 ID | 类型 | 价格 | 下载次数 |
|---------|------|------|----------|
| `com.beatsync.pack.10` | **消耗型产品** ⭐ | ¥5 | 10次 |
| `com.beatsync.pack.50` | **消耗型产品** ⭐ | ¥20 | 50次 |
| `com.beatsync.pack.100` | **消耗型产品** ⭐ | ¥35 | 100次 |

---

## 🔄 如果已经创建为非消耗型产品怎么办？

### 情况 1：还未提交审核

**解决方法**：
1. 删除已创建的产品
2. 重新创建为**消耗型产品**

### 情况 2：已提交审核或已上线

**解决方法**：
1. ⚠️ **不能直接修改产品类型**
2. ⚠️ 需要创建新的产品（消耗型产品）
3. ⚠️ 更新产品 ID（例如：`com.beatsync.pack.10.consumable`）
4. ⚠️ 更新代码中的产品 ID
5. ⚠️ 下架旧产品（非消耗型产品）

**注意**：这会带来一些麻烦，建议在审核前修正。

---

## 📋 修正后的产品创建指南

### 创建消耗型产品（以 10次下载包为例）

1. **产品类型**：选择 **"消耗型产品（Consumable）"** ⭐
2. **产品 ID**：`com.beatsync.pack.10`
3. **参考名称**：`10次下载包`
4. **价格**：`¥5.00`
5. **显示名称**：`10次下载包`
6. **描述**：
   ```
   购买后获得10次下载次数。每次下载消耗1次，用完后可以再次购买。
   ```

---

## ⚠️ 重要提示

### 消耗型产品 vs 非消耗型产品

**消耗型产品（Consumable）**：
- ✅ 可以多次购买
- ✅ 适合下载次数包
- ✅ 用户用完可以再次购买

**非消耗型产品（Non-Consumable）**：
- ❌ 只能购买一次
- ❌ 不适合下载次数包
- ❌ 用户用完不能再次购买

### 为什么之前建议错误？

可能的原因：
1. 混淆了"一次性购买"和"非消耗型产品"的概念
2. 没有仔细分析业务逻辑
3. 没有考虑用户可以多次购买的需求

### 正确的理解

- **"一次性购买"**：指用户每次购买时支付一次费用（不是订阅）
- **"消耗型产品"**：指产品可以多次购买，每次购买都会消耗
- **"非消耗型产品"**：指产品只能购买一次，永久拥有

对于下载次数包：
- ✅ 是"一次性购买"（不是订阅）
- ✅ 应该是"消耗型产品"（可以多次购买）
- ❌ 不是"非消耗型产品"（只能购买一次）

---

## 🎯 总结

### 修正

- ❌ **之前错误**：下载次数包使用"非消耗型产品"
- ✅ **正确选择**：下载次数包使用"消耗型产品"

### 原因

- ✅ 用户可以多次购买同一个产品
- ✅ 每次购买都会消耗
- ✅ 用完后需要再次购买

### 行动

- ⚠️ 如果还未创建产品：使用"消耗型产品"
- ⚠️ 如果已创建为非消耗型产品：需要删除并重新创建

---

**抱歉之前的错误建议！应该使用消耗型产品。** 🙏
