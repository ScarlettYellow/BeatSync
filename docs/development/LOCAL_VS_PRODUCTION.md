# 本地服务与线上服务说明

> **目的**：说明本地开发服务和线上生产服务的区别和独立性

---

## 服务架构说明

### 本地服务（开发环境）

**运行位置**：您的电脑（本地）

**服务地址**：
- 后端服务：`http://localhost:8000`
- 前端页面：`http://localhost:8080`

**启动方式**：
```bash
cd web_service
./start_local.sh
```

**特点**：
- 只在您的电脑上运行
- 只能从您的电脑访问
- 用于本地开发和测试
- 停止后不影响其他任何服务

---

### 线上服务（生产环境）

**运行位置**：腾讯云服务器（远程）

**服务地址**：
- 后端API：`https://124.221.58.149`
- 前端页面：`https://scarlettyellow.github.io/BeatSync/`

**启动方式**：
- 通过systemd服务自动启动
- 服务器重启后自动启动
- 无需手动启动

**特点**：
- 在腾讯云服务器上运行
- 可以从任何地方访问
- 用于生产环境
- 独立于本地服务运行

---

## 服务独立性

### 完全独立

**本地服务和线上服务是完全独立的**：

```
┌─────────────────┐         ┌─────────────────┐
│   本地服务       │         │   线上服务       │
│  (您的电脑)      │         │  (腾讯云服务器)  │
│                 │         │                 │
│ localhost:8000  │         │ 124.221.58.149  │
│ localhost:8080  │         │ (HTTPS)         │
└─────────────────┘         └─────────────────┘
        │                            │
        │                            │
        └──────── 互不影响 ──────────┘
```

**关键点**：
- ✅ 本地服务停止 → **不影响**线上服务
- ✅ 线上服务停止 → **不影响**本地服务
- ✅ 它们运行在不同的服务器上
- ✅ 它们使用不同的端口
- ✅ 它们没有依赖关系

---

## 常见场景

### 场景1：停止本地服务

**操作**：在终端按 `Ctrl+C` 停止本地服务

**影响**：
- ❌ **不影响**线上服务
- ❌ **不影响**其他用户
- ❌ **不影响**GitHub Pages前端
- ✅ 只影响您本地的开发环境

**结果**：
- 您无法在本地访问 `http://localhost:8000` 和 `http://localhost:8080`
- 线上服务继续正常运行
- 其他用户可以正常使用线上服务

---

### 场景2：重启本地服务

**操作**：重新运行 `./start_local.sh`

**影响**：
- ❌ **不影响**线上服务
- ✅ 只影响您本地的开发环境

**结果**：
- 本地服务重新启动
- 可以继续本地开发
- 线上服务不受影响

---

### 场景3：修改本地代码

**操作**：在本地修改代码

**影响**：
- ❌ **不影响**线上服务（除非推送到GitHub并部署）

**结果**：
- 本地修改只影响本地服务
- 需要推送到GitHub才会影响线上服务

---

## 服务管理

### 本地服务管理

**启动**：
```bash
cd web_service
./start_local.sh
```

**停止**：
- 在终端按 `Ctrl+C`
- 或使用：`kill <PID>`

**查看日志**：
```bash
tail -f backend.log
tail -f frontend.log
```

---

### 线上服务管理

**查看状态**：
```bash
# 在服务器上执行
ssh ubuntu@124.221.58.149
sudo systemctl status beatsync
```

**重启服务**：
```bash
# 在服务器上执行
sudo systemctl restart beatsync
```

**查看日志**：
```bash
# 在服务器上执行
sudo journalctl -u beatsync -f
```

---

## 数据存储位置

### 本地服务

**数据存储**：
- 上传文件：`web_service/web_uploads/`
- 输出文件：`web_service/web_outputs/`
- 日志文件：`web_service/backend.log`、`web_service/frontend.log`

**位置**：您的电脑本地

---

### 线上服务

**数据存储**：
- 上传文件：`/opt/beatsync/web_uploads/`
- 输出文件：`/opt/beatsync/web_outputs/`
- 日志文件：systemd日志、`/opt/beatsync/outputs/logs/`

**位置**：腾讯云服务器

---

## 开发工作流

### 本地开发流程

1. **启动本地服务**
   ```bash
   cd web_service
   ./start_local.sh
   ```

2. **在本地开发和测试**
   - 访问 `http://localhost:8080`
   - 测试功能
   - 修改代码

3. **停止本地服务**（不影响线上）
   - 按 `Ctrl+C`

4. **提交代码**
   ```bash
   git add .
   git commit -m "feat: 新功能"
   git push origin main
   ```

5. **线上服务自动更新**（如果配置了自动部署）
   - GitHub Pages自动部署前端
   - 服务器需要手动更新代码

---

## 重要提醒

### 本地服务

- ✅ 可以随时启动和停止
- ✅ 停止后不影响线上服务
- ✅ 只影响您本地的开发环境

---

### 线上服务

- ⚠️ 停止线上服务会影响所有用户
- ⚠️ 需要谨慎操作
- ⚠️ 建议在维护时间窗口操作

---

## 总结

**本地服务停止的影响**：
- ❌ **不影响**线上服务
- ❌ **不影响**其他用户
- ❌ **不影响**GitHub Pages
- ✅ 只影响您本地的开发环境

**关键点**：
- 本地服务和线上服务完全独立
- 它们运行在不同的服务器上
- 它们使用不同的端口和地址
- 它们没有依赖关系

**您可以放心地停止本地服务，不会影响线上服务的正常使用。**

---

**最后更新**：2025-12-02

